Scripts apapted from https://github.com/TheCherno/Hazel